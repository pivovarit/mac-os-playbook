- name: Add zsh
  lineinfile: >
    backup=yes
    dest=/etc/shells
    regexp=^/usr/local/bin/zsh
    line=/usr/local/bin/zsh
  when: ansible_os_family == 'Darwin'
  become: true

- name: Set zsh as Default
  shell: chsh -s /usr/local/bin/zsh {{ ansible_env.USER }}
  when: ansible_os_family == 'Darwin'
  become: true

- name: Ensuring oh-my-zsh Is Installed
  stat:
    path: "~/.oh-my-zsh"
  register: "oh-my-zsh_check"

- name: Installing oh-my-zsh
  command: 'sh -c "$(curl -fsSL https://raw.githubusercontent.com/robbyrussell/oh-my-zsh/master/tools/install.sh)"'
  when: not oh-my-zsh_check.stat.exists
